ğŸ“„ Specifiche implementazione inviti WordPress per gioco multiplayer Unity3D con Relay
ğŸ¯ Obiettivo
Permettere a un utente pagante sulla piattaforma WordPress di:
Selezionare un gioco Unity (WebGL) disponibile
Invitare fino a 3 utenti registrati
Avviare una sessione multiplayer in tempo reale usando Unity Relay
Gestire tutto il flusso tramite WordPress, senza dipendenze da Unity Lobby

ğŸ§© Componenti principali


ğŸ“¦ Struttura dati (DB)
Tabella: wp_game_sessions


Tabella: wp_game_session_invites


ğŸ”— Link invito
Ogni sessione genera un link del tipo:

https://miosito.it/gioca?invito=56fb1d23-aa22-4ed3-910b-8c29ab763111
Solo:
Lâ€™host (creatore)
Gli invitati specificati
possono accedere al gioco via questo link (autenticazione WP obbligatoria).

âš™ï¸ Flusso dâ€™uso
ğŸŸ¢ Creazione sessione (host)
Lâ€™utente paga o ha diritto a giocare
Seleziona un gioco Unity
Sceglie fino a 3 utenti da una rubrica (autocomplete WP)
Clicca â€œCrea partitaâ€
WordPress:
Registra la sessione (wp_game_sessions)
Registra gli invitati (wp_game_session_invites)
Genera link univoco
Lâ€™interfaccia mostra il link da condividere

ğŸŸ¡ Avvio sessione (Unity host)
Lâ€™host apre il link da loggato
WordPress verifica che Ã¨ lâ€™host â†’ carica Unity WebGL
Unity crea Relay Allocation (es. per 3 peer)
Unity ottiene joinCode â†’ lo invia a WP via:POST /wp-json/game/v1/set-join-code
{ invito_uuid: "...", joinCode: "XYZ123" }


ğŸ”µ Accesso invitati
Lâ€™invitato apre il link da loggato
WordPress verifica che Ã¨ nella lista â†’ carica Unity WebGL
Unity inizia a fare polling:GET /wp-json/game/v1/get-join-code?invito_uuid=...
â†’ finchÃ© non riceve joinCode
Unity si connette a Relay con il codice

ğŸ”„ API REST (WordPress â†’ Unity)
GET /wp-json/game/v1/get-join-code
Input: invito_uuidOutput:

{
  "status": "ok",
  "joinCode": "XYZ123",
  "isGuest": true,
  "guestId": 123
}

POST /wp-json/game/v1/set-join-code
Input:

{
  "invito_uuid": "56fb1d23-aa22-...",
  "joinCode": "XYZ123"
}
Autenticazione: host loggatoEffetto: aggiorna la sessione

ğŸ” Sicurezza
Tutti gli accessi richiedono current_user loggato
Verifiche su:
is_host â†’ puÃ² inviare joinCode
is_invited_user â†’ puÃ² accedere al gioco
I link di invito sono non condivisibili con utenti non autorizzati

â³ Timeout e gestione errori


ğŸ”§ Estensioni future (opzionali)
Notifiche email agli invitati
Pannello â€œLe mie partiteâ€ per host e guest
Riconnessione a sessioni attive
Chat pre-partita
Statistiche post-partita

âœ… Requisiti minimi sistema



	